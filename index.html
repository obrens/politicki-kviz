<!doctype html>
<html lang="sr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Брзи политички квиз</title>
<style>
body { font-family: system-ui, sans-serif; background: #f0f1f5; margin: 0; padding: 0; }
.wrapper { max-width: 1100px; margin: 32px auto; background: #fff; padding: 32px; border-radius: 20px; box-shadow: 0 6px 25px rgba(0,0,0,0.1); }
@media (max-width: 1150px) {
  .wrapper { max-width: 500px; }
}
h1 { text-align: center; font-size: 32px; font-weight: 800; margin-top: 0; color: #2c3e50; }
p.subtitle { text-align: center; color: #555; margin-top: 4px; font-size: 16px; }

#quiz { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
@media (max-width: 1150px) {
  #quiz { grid-template-columns: 1fr; }
}
.topic-separator { grid-column: 1 / -1; height: 1px; background: linear-gradient(to right, transparent, #d0d5dd 20%, #d0d5dd 80%, transparent); margin: 8px 0; position: relative; }
.topic-separator::before { content: attr(data-topic); position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); background: #f0f1f5; padding: 4px 16px; font-size: 13px; font-weight: 600; color: #6b7280; letter-spacing: 0.5px; }
.question { background: #fff; border-left: 6px solid #7b8a9e; border-radius: 12px; padding: 16px 16px 12px 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); display: flex; flex-direction: column; }
.question div:first-child { font-size: 16px; font-weight: 600; color: #2c3e50; line-height: 1.3; }

.yesno { display: flex; justify-content: space-around; margin-top: 8px; gap:8px; }
.yesno label { flex:1; cursor: pointer; font-size: 14px; text-align: center; }
.yesno input { display: none; }
.yesno span { display: block; padding: 8px 0; border-radius: 8px; border: 2px solid #ccc; transition: all 0.2s; font-weight: 600; background: #fff; }
.yesno input:checked + span { background:#4a6ea9; color:#fff; border-color:#4a6ea9; transform: scale(1.05); }

.controls { display: flex; gap: 12px; margin: 24px 0; flex-wrap: wrap; }
button { flex-shrink:0; padding: 12px 20px; border: none; border-radius: 12px; background: #4a6ea9; color: white; font-weight: 600; cursor: pointer; transition: background 0.2s; }
button:hover { background: #3b5780; }
#shareLink { flex-grow: 1; padding: 12px; border-radius: 8px; border: 1px solid #ccc; }

footer { margin-top: 40px; color: #666; font-size: 14px; text-align: center; }

#shareableBars { margin-top: 32px; padding: 24px; background: #fff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
#shareableBars h2 { text-align: center; color: #2c3e50; font-size: 24px; font-weight: 700; margin: 0 0 24px 0; }
.shareBar { margin: 24px 0; }
.shareBar strong { display: block; margin-bottom: 8px; color: #2c3e50; font-size: 16px; font-weight: 600; }
.shareBar .spectrum { position: relative; height: 8px; background: linear-gradient(to right, #e8edf2 0%, #d4dce5 50%, #e8edf2 100%); border-radius: 4px; margin: 12px 0; }
.shareBar .marker { position: absolute; top: 50%; transform: translate(-50%, -50%); width: 20px; height: 20px; background: #4a6ea9; border: 3px solid #fff; border-radius: 50%; box-shadow: 0 2px 8px rgba(74,110,169,0.4); transition: all 0.3s ease; }
.shareBar .labels { display: flex; justify-content: space-between; font-size: 14px; margin-top: 8px; }
.shareBar .labels span { color: #6b7280; font-weight: 500; }
.shareBar .labels span.highlight { font-weight: 700; color: #2c3e50; }
</style>
</head>
<body>
<div class="wrapper">
<h1>Брзи политички квиз</h1>
<p class="subtitle">Квиз политичке оријентације у српској политици</p>

<div id="quiz"></div>

<div class="controls">
  <button id="show">Прикажи резултат</button>
  <button id="reset">Ресетуј</button>
  <button id="copyLink">Копирај линк</button>
  <input id="shareLink" readonly />
</div>

<div id="shareableBars"></div>

<footer>
Економија: тржишна — државна · Спољна политика: антизападна — прозападна · Ауторитет: аутократија — револуција · Култура: традиционална — прогресивна
</footer>
</div>

<script>
const axes = [
  { id:0, name:"Економија", left:"тржишна", right:"државна" },
  { id:1, name:"Спољна политика", left:"антизападна", right:"прозападна" },
  { id:2, name:"Ауторитет", left:"аутократија", right:"револуција" },
  { id:3, name:"Култура", left:"традиционална", right:"прогресивна" }
];

const questions = [
  {axis:0, dir:1,  text:"Превише тога смо приватизовали"},
  {axis:0, dir:1,  text:"Капитализам је довео до превелике разлике између богатих и сиромашних"},
  {axis:0, dir:-1, text:"Државни пензиони систем је попут пирамидалне шеме, и мора се хитно реформисати или приватизовати"},

  {axis:1, dir:1, text:"Србија треба да уђе у ЕУ или НАТО"},
  {axis:1, dir:-1, text:"Превише слушамо диктате међународних институција попут Хашког трибунала, ММФ-а, Светске здравствене организације"},
  {axis:1, dir:1, text:"Морамо да прихватимо реалност по питању Косова како бисмо напредовали"},

  {axis:2, dir:1, text:"Треба да се чувамо да нам се не догоди обојена револуција"},
  {axis:2, dir:-1, text:"Србији фали људских права и демократије"},
  {axis:2, dir:1, text:"Неке странке, медије или политичаре треба забранити"},

  {axis:3, dir:1, text:"Треба укинути школску славу — нисмо сви Православци"},
  {axis:3, dir:-1, text:"ЛГБТ пропаганда је штетна за друштво"},
  {axis:3, dir:-1, text:"По питању имиграције треба више да се угледамо на Мађарску него на Шведску"}
];

// Generate quiz
const quizDiv = document.getElementById('quiz');
let lastAxis = -1;
questions.forEach((q,i)=>{
  if(q.axis !== lastAxis){
    const sep = document.createElement('div');
    sep.className = 'topic-separator';
    sep.setAttribute('data-topic', axes[q.axis].name.toUpperCase());
    quizDiv.appendChild(sep);
    lastAxis = q.axis;
  }
  
  const d = document.createElement('div'); 
  d.className='question';
  const p = document.createElement('div'); 
  p.textContent = q.text;
  const btnDiv = document.createElement('div'); 
  btnDiv.className='yesno';
  
  [{label:'Не',value:-1},{label:'Да',value:1}].forEach(opt=>{
    const lab = document.createElement('label');
    lab.innerHTML = `<input type="radio" name="q${i}" value="${opt.value}" ${opt.value===-1?'checked':''}><span>${opt.label}</span>`;
    btnDiv.appendChild(lab);
  });
  
  d.appendChild(p); 
  d.appendChild(btnDiv);
  quizDiv.appendChild(d);
});

// Calculate scores
function score() {
  const scores = [0,0,0,0];
  const counts = [0,0,0,0];
  
  questions.forEach((q,i)=>{
    const val = Number(document.querySelector(`input[name=q${i}]:checked`).value);
    scores[q.axis] += val * q.dir;
    counts[q.axis]++;
  });
  
  return scores.map((s,i) => s / counts[i]);
}

// Encode/decode
function encode(a){ try { return btoa(a.join(',')); } catch{ return ''; } }
function decode(s){ try { return atob(s).split(',').map(Number); } catch{ return null; } }

// Render results
function renderShareableBars(res){
  const container = document.getElementById('shareableBars');
  container.innerHTML = '<h2>Ваш политички компас</h2>';
  
  axes.forEach((ax,i)=>{
    const val = res[i];
    const position = 50 + val * 50;
    const bar = document.createElement('div'); 
    bar.className='shareBar';
    bar.innerHTML = `
      <strong>${ax.name}</strong>
      <div class="spectrum">
        <div class="marker" style="left:${position}%"></div>
      </div>
      <div class="labels">
        <span class="${val<0?'highlight':''}">${ax.left}</span>
        <span class="${val>0?'highlight':''}">${ax.right}</span>
      </div>`;
    container.appendChild(bar);
  });
  
  const answers = questions.map((q,i)=> Number(document.querySelector(`input[name=q${i}]:checked`).value) * q.dir);
  document.getElementById('shareLink').value = location.origin + location.pathname + '?r=' + encode(answers);
}

// Buttons
document.getElementById('show').onclick = () => renderShareableBars(score());
document.getElementById('reset').onclick = () => location.reload();
document.getElementById('copyLink').onclick = () => { 
  const el=document.getElementById('shareLink'); 
  el.select(); 
  document.execCommand('copy'); 
  alert('Копирано!'); 
};

// Pre-fill from URL
(function(){
  const p = new URLSearchParams(location.search);
  if(p.has('r')){
    const dec = decode(p.get('r'));
    if(dec && dec.length === questions.length){
      dec.forEach((v,i)=>{
        const el = document.querySelector(`input[name=q${i}][value='${v>0?1:-1}']`);
        if(el) el.checked = true;
      });
      renderShareableBars(score());
    }
  }
})();
</script>
</body>
</html>
